<html>

	<head>

		<title>CIS 4900 - I Hou Tong</title>
	
		<link href="css/bootstrap.min.css" rel="stylesheet">
		<link href="css/bootstrap-theme.min.css" rel="stylesheet">
		<link href="css/style.css" rel="stylesheet">
		
	</head>

	<body>
	
		<!-- Setting up the navigation for the website -->
		<nav class="navbar-inverse navbar navbar-fixed-top" role="navigation">
			<div class="container-fluid">
				<div class="navbar-header">
					<!-- Displaying the program name on left of navigation -->
					<div class="navbar-brand">Environmental Simulator</div>
				</div>
				
				<!-- Set up the navigation -->
				<div class="collapse navbar-collapse">
						<ul class="nav navbar-nav">
						<li class="active"> <a href="home.html"> Home </a> </li>
						<li> <a href="map.html"> Map </a> </li>
						<li> <a href="technology.html"> Technology </a> </li>
						<li> <a href="jobs.html"> Jobs </a> </li>
					</ul>
					
					<ul class="nav navbar-nav navbar-right">
						<li> <a id="timeElapsed"></a></li>
						<li> <a id="population"></a></li>
						<li> <a id="happiness"></a></li>
						<li> <a id="pollution"></a></li>
						<li> <a href="stats.html" id="playerName"></a> </li>
						<li class="dropdown">
							<a href="#" class="dropdown-toggle" data-toggle="dropdown">
								More <span class="caret"></span>
							</a>
							<ul class="dropdown-menu" role="menu">
								<li> <a href="help.html"> Help </a> </li>
								<li> <a href="sources.html"> Sources </a> </li>
								<li> <a href="facts.html">Facts</a></li>
								<li> <a onclick="restartGame()">Restart</a></li>
							</ul>
						</li>
						
					</ul>
				</div>
			</div>  <!--end of container -->
		</nav> <!-- end of navigation -->
		
		<div class="container">
			<div class="col-md-12">
				<div id="alert"></div>
			</div>
		</div>
		
		<div class="float-left-nomap">
			<textarea class="textarea-hide-scroll" id="npcChatter" rows="15" cols="60" readonly></textarea>
		</div>
		
		<div class="float-right-nomap">
			<table id="resource"></table>
		</div>
	
	<script src="js/common.js"></script>
	<script src="js/jquery.min.js"></script>
	<script src="js/bootstrap.js"></script>
	<script src="message.js"></script>
	<script>
		
		//calls returnPlayer which returns the player objects
		var player = returnPlayer();
		//convertAllPlayerResourceToInt();
		//function calls to set up the page
		calculateEverythingFromLastUpdate();
		displayResources();
		displayNPCChatter();
		displayNavBarStat();
		saveBeforeUnload();
		
		//sets a timer to call addtoNPCChatter every minute.
		setInterval(function(){
			addToNPCChatter();
		}, 60000);
		
		
		/* No longer used. Was originally used to increment resources. This is now down in calculateEverythingFromLastUpdate()
		function increaseResourceAuto(){
			for (var i in player.playerResource){
				if (player.playerResource[i].currentAmount < player.playerResource[i].totalCapacity){
					player.playerResource[i].currentAmount += player.playerResource[i].amountPerMonth;
				}
			}
		}*/
		
		//empties everything in the textarea tag with the id npcChatter
		//then it loops through player.npcMessages and appends each message to the textarea
		function displayNPCChatter(){
			$("#npcChatter").empty();
			for (var i in player.npcMessages){
				$("#npcChatter").append(player.npcMessages[i] + "\n");
			}
		}
		
		//checks if the size of npcMessages array is greater than 15
		//if it is then it deletes the last one (at index 14)
		//then it adds a new message to the front of the array
		//calls displayNPCChatter() to display the new message
		function addToNPCChatter(){
			if (player.npcMessages.length > 15){
				player.npcMessages.splice(14, 1);
			}
			player.npcMessages.unshift(messages[Math.floor(Math.random() * 13)]);
			displayNPCChatter();
		}
		
		//functions I used to test the timer previously.
		//This was for something that was originally part of the home page design
		//I had decided it wasn't necessary and so the code is no longer needed.
		/*
		setInterval(function(){
			$("#job1").empty();
			job1completion++;
			$("#job1").append("Job 1 completion rate: "+job1completion);
		}, 1000);
		
		setInterval(function(){
			$("#job2").empty();
			job2completion++;
			$("#job2").append("Job 2 completion rate: "+job2completion);
		}, 1000);
		*/
	</script>
	</body>
</html>